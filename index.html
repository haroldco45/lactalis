<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos Lactalis - Distrileco</title>
    <style>
        :root {
            --lactalis-green: #4CAF50;
            --parmalat-blue: #0056b3;
            --proleche-orange: #f39c12;
            --bg-color: #f8f9fa;
        }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg-color); margin: 0; padding: 10px; padding-bottom: 140px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { text-align: center; color: var(--lactalis-green); margin-bottom: 5px; }
        .subtitle { text-align: center; color: #666; font-size: 0.9rem; margin-bottom: 20px; }
        .input-group { margin-bottom: 15px; }
        input[type="text"], input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85rem; }
        th { background-color: var(--lactalis-green); color: white; padding: 10px; text-align: left; }
        td { padding: 8px; border-bottom: 1px solid #eee; }
        .cant-input, .desc-input { width: 60px; text-align: center; padding: 5px !important; }
        .total-pedido-bar { position: fixed; bottom: 85px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 10px 20px; border-radius: 10px; width: 80%; max-width: 400px; text-align: center; font-weight: bold; z-index: 999; }
        .btn-whatsapp { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #25d366; color: white; padding: 15px; border-radius: 50px; text-decoration: none; font-weight: bold; width: 85%; max-width: 350px; text-align: center; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .precio-final { font-weight: bold; color: var(--parmalat-blue); }
    </style>
</head>
<body>

<div class="container">
    <h1>Portafolio Lactalis</h1>
    <p class="subtitle">Preventa y Distribuci√≥n - Distrileco</p>
    
    <div class="input-group">
        <input type="text" id="cliente" placeholder="Nombre del Cliente...">
    </div>
    <div class="input-group">
        <input type="text" id="buscador" placeholder="üîé Buscar producto...">
    </div>

    <table>
        <thead>
            <tr>
                <th>Producto</th>
                <th>Cant.</th>
                <th>P. Base</th>
                <th>Desc %</th>
                <th>Neto</th>
            </tr>
        </thead>
        <tbody id="tabla-body"></tbody>
    </table>
</div>

<div class="total-pedido-bar">Total Pedido: $<span id="total-general">0</span></div>

<a href="javascript:void(0)" class="btn-whatsapp" onclick="enviarPedido()">
    ENVIAR PEDIDO POR WHATSAPP
</a>

<script>
    // Precios base de ejemplo (aj√∫stalos seg√∫n tu lista real)
    const productosLactalis = [
        { ref: "0882", nombre: "LECHE CONDENSADA PARMA 15*400G", precio: 45000 },
        { ref: "0883", nombre: "LECHE CONDENSADA PARMA 28*100M", precio: 32000 },
        { ref: "0936", nombre: "AREQUIPE PROLECHE 12DIP*24UND", precio: 28500 },
        { ref: "10245", nombre: "AREQUIPE PROLECHE 48*150GR", precio: 52000 },
        { ref: "10689", nombre: "CREMA DE LECHE REPOS 12*1 LT", precio: 85000 },
        { ref: "11054", nombre: "LECHE PROLE DESLACTOSADA 30*380G", precio: 98000 }
    ];

    const pedido = {};

    function renderizar(filtro = "") {
        const body = document.getElementById('tabla-body');
        body.innerHTML = "";
        const filtrados = productosLactalis.filter(p => p.nombre.toLowerCase().includes(filtro.toLowerCase()));

        filtrados.forEach(p => {
            const d = pedido[p.ref] || { cant: 0, desc: 0 };
            const neto = p.precio * (1 - (d.desc / 100));
            
            body.innerHTML += `<tr>
                <td>${p.nombre}<br><small>${p.ref}</small></td>
                <td><input type="number" class="cant-input" value="${d.cant || ''}" oninput="actualizar('${p.ref}', 'cant', this.value)"></td>
                <td>$${p.precio.toLocaleString()}</td>
                <td><input type="number" class="desc-input" value="${d.desc || ''}" oninput="actualizar('${p.ref}', 'desc', this.value)"></td>
                <td class="precio-final">$${Math.round(neto).toLocaleString()}</td>
            </tr>`;
        });
    }

    function actualizar(ref, campo, valor) {
        if (!pedido[ref]) pedido[ref] = { cant: 0, desc: 0 };
        pedido[ref][campo] = parseFloat(valor) || 0;
        calcularTotal();
        if (campo === 'desc') renderizar(document.getElementById('buscador').value);
    }

    function calcularTotal() {
        let total = 0;
        for (const ref in pedido) {
            const p = productosLactalis.find(prod => prod.ref === ref);
            const neto = p.precio * (1 - (pedido[ref].desc / 100));
            total += pedido[ref].cant * neto;
        }
        document.getElementById('total-general').innerText = Math.round(total).toLocaleString();
    }

    function enviarPedido() {
        const cliente = document.getElementById('cliente').value || 'No indicado';
        let totalG = 0;
        let lineas = [];

        for (const ref in pedido) {
            if (pedido[ref].cant > 0) {
                const p = productosLactalis.find(prod => prod.ref === ref);
                const neto = p.precio * (1 - (pedido[ref].desc / 100));
                const subtotal = pedido[ref].cant * neto;
                totalG += subtotal;
                lineas.push(`‚úÖ ${p.nombre}\nCant: ${pedido[ref].cant} | Desc: ${pedido[ref].desc}%\nSubtotal: $${Math.round(subtotal).toLocaleString()}`);
            }
        }

        if (lineas.length === 0) return alert("Pedido vac√≠o");

        const msg = `*PEDIDO DISTRILECO*\nüë§ *Cliente:* ${cliente}\n\n${lineas.join('\n\n')}\n\nüí∞ *TOTAL PEDIDO: $${Math.round(totalG).toLocaleString()}*`;
        window.open(`https://wa.me/573117700431?text=${encodeURIComponent(msg)}`, '_blank');
    }

    window.onload = renderizar;
    document.getElementById('buscador').oninput = (e) => renderizar(e.target.value);
</script>
</body>
</html>
